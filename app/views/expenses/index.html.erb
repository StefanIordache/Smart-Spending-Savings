<%= render 'layouts/fuse' %>

<main>

  <div id="wrapper">

    <%= render 'layouts/sidebar' %>

    <div class="content-wrapper">
      <%= render 'layouts/navbar' %>
      <div class="content custom-scrollbar">

        <div class="page-layout blank p-6">

          <div class="jumbotron jumbotron-title">
            <h2 class="display-4">Your Expenses</h2>
          </div>


          <div class="custom-table-container">
            </br>

            <div class="text-center">
              <%= link_to new_expense_path(@expense), class: "btn btn-info" do %>
<!--  Astea trebuie puse pt a deschide modalul de la finalul fisierului-->
<!--  , "data-toggle" => "modal",-->
<!--  , "data-target" => "#RaportModal"-->

                <i class="fas fa-plus-circle"></i> Add New Expense
              <% end %>
            </div>

            <% if @expenses.length > 0 %>
              <table id="expenses_table" class="container">
                <thead>
                <tr>
                  <th><h1>Expense Title</h1></th>
                  <th><h1>Amount</h1></th>
                  <th><h1>Date</h1></th>
                  <th><h1>Description</h1></th>
                  <th><h1>Actions</h1></th>
                </tr>
                </thead>
                <tbody>
                <% @expenses.each do |expense| %>
                  <tr>
                    <td><%= link_to expense.title, expense_path(expense) %></td>
                    <td><%= expense.amount.to_s + ' ' + expense.currency.to_s.humanize.upcase %></td>
                    <td><%= expense.expense_date %></td>
                    <td><%= expense.description %></td>
                    <td>

                      <%= link_to edit_expense_path(expense), class: "btn btn-info" do %>
                        <i class="fas fa-edit"></i>
                      <% end %>

                      <%= link_to expense_path(expense), method: :delete, data: {confirm: 'Are you sure?'}, class: "btn btn-sm btn-danger" do %>
                        <i class="fas fa-trash-alt"></i>
                      <% end %>

                    </td>
                  </tr>
                <% end %>
                </tbody>
              </table>
            <% else %>
              <div class="p-3 no-expenses-msg">
                <section id="warning">
                  <section class="warningContent">
                    <span>!</span>
                    <h5 class="wHeading">We are sorry</h5>
                    <p>You don't have any expenses registered on our platform!</p>
                  </section>
                </section>
              </div>

            <% end %>
          </div>

        </div>

      </div>
    </div>

  </div>
  <div aria-hidden="true"
       aria-labelledby="RaportModalLabel"
       class="modal fade"
       id="RaportModal"
       role="dialog"
       tabindex="-1">
    <div class="modal-dialog modal-lg"
         role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="RaportLabel">
            Raport
          </h5>
          <button type="button"
                  class="close"
                  data-dismiss="modal"
                  aria-label="Cancel">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="jumbotron jumbotron-title">
            <h2 class="display-4">Add New Expense</h2>
          </div>

          </br>
          </br>
          <div class="container">
            <div class="row">
              <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xs-offset-0 col-sm-offset-0 col-md-offset-3 col-lg-offset-3 toppad">
<!--                Formularul nu poate fi randat pt ca are parametrul ala @expense in el-->
<!--                Propun sa inserezi formularul gol-->
<!--                => Pt add ramane gol si il completam noi-->
<!--                => Pt edit facem un ajax catre o ruta care ne intorce obiectul cu care noi dupa populam inputurile-->
<!--                => Pt show putem sa facem ca mai sus + inputurile nu mai sunt editabile-->
                <%#= render 'form' %>
              </div>
            </div>
          </div>

          </br>
          </br>

        </div>
        <div class="modal-footer">
          <button type="button"
                  class="btn btn-outline-danger"
                  data-dismiss="modal">
            Cancel
          </button>
          <button type="button"
                  class="btn btn-outline-success"
                  id="confirmRaport">
            Save
          </button>
        </div>
      </div>
    </div>
  </div>
</main>


<script type="text/javascript">

    <% if @expenses.length > 0 %>
    $(document).ready(function () {
        $('#expenses_table').DataTable();
    });
    <% end %>

</script>